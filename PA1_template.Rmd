# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data

```{r load.and.preprocess}
act <- read.csv("activity.csv")
data <- act[complete.cases(act),]  # only data without missing values
```


## What is mean total number of steps taken per day?

First, we compute the total of steps taken in each day:
```{r steps.in.each.day}
steps.by.day <- aggregate(list(steps=data$steps),
                          by = list(date=data$date), sum)
```

Whose frequencies are characterised by the following histogram
```{r histogram, echo = FALSE}
hist(steps.by.day$steps, xlab="Steps", main="Total steps taken per day")
```

The values of the mean and the median are:
```{r basic.stats, echo = FALSE}
mean(steps.by.day$steps)
median(steps.by.day$steps)
```

## What is the average daily activity pattern?

First we compute the average by day and by eah interval of time:
```{r avg.steps}
step.avg.by.day <- aggregate(list(avg=data$steps),
                             by=list(interval=data$interval), mean)
head(step.avg.by.day)
```

Now we plot the average through the day time:

```{r plot.avg.steps, echo = FALSE}
plot(steps.avg.by.day$interval, steps.avg.by.day$avg, type = "l",
     main = "Average steps through the day",
     xlab = "Interval (5 min) in the day",
     ylab = "Number of steps")
max.idx <- which.max(steps.avg.by.day$avg)
```

where the maximum 5-minute interval is:
```{r, echo=FALSE}
steps.avg.by.day$avg[max.idx]

```
Corresponding to
```{r, echo=FALSE}
max.hour <- steps.avg.by.day$interval[max.idx]
message(as.integer(max.hour/100), " hours and ", max.hour %%  100, " minutes")
```


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
